<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Financial Insights - Smart Finance Assistant</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .insight-card { border-left: 4px solid #007bff; }
        .health-score { font-size: 2.5rem; font-weight: bold; }
        .score-excellent { color: #28a745; }
        .score-good { color: #17a2b8; }
        .score-fair { color: #ffc107; }
        .score-poor { color: #dc3545; }
        .ai-badge { background: linear-gradient(45deg, #667eea, #764ba2); }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand" href="/">
            <i class="fas fa-piggy-bank me-2"></i>Smart Finance Assistant
        </a>
        <div class="navbar-nav ms-auto">
            <a class="nav-link" href="/accounts">Accounts</a>
            <a class="nav-link" href="/transactions">Transactions</a>
            <a class="nav-link" href="/budgets">Budgets</a>
            <a class="nav-link active" href="/insights">AI Insights</a>
        </div>
    </div>
</nav>
<div class="container mt-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <h2><i class="fas fa-brain me-2"></i>AI Financial Insights</h2>
            <p class="text-muted">Powered by ChatGPT â€¢ Personalized advice based on your financial data</p>
        </div>
    </div>
    <!-- Error Message -->
    <div th:if="${errorMessage}" class="alert alert-danger">
        <i class="fas fa-exclamation-triangle me-2"></i>
        <span th:text="${errorMessage}">Error message</span>
    </div>
    <!-- Financial Health Score -->
    <div class="row mb-4" th:if="${healthScore}">
        <div class="col-12">
            <div class="card">
                <div class="card-body text-center">
                    <h5 class="card-title">Financial Health Score</h5>
                    <div class="health-score"
                         th:class="${healthScore >= 80} ? 'health-score score-excellent' :
                                       (${healthScore >= 60} ? 'health-score score-good' :
                                       (${healthScore >= 40} ? 'health-score score-fair' : 'health-score score-poor'))"
                         th:text="${healthScore} + '/100'">75/100</div>
                    <div class="progress mt-3" style="height: 10px;">
                        <div class="progress-bar"
                             th:class="${healthScore >= 80} ? 'progress-bar bg-success' :
                                           (${healthScore >= 60} ? 'progress-bar bg-info' :
                                           (${healthScore >= 40} ? 'progress-bar bg-warning' : 'progress-bar bg-danger'))"
                             th:style="'width: ' + ${healthScore} + '%'"></div>
                    </div>
                    <small class="text-muted mt-2 d-block">
                        Based on savings rate, account diversity, and net worth
                    </small>
                </div>
            </div>
        </div>
    </div>
    <!-- AI Insights Grid -->
    <div class="row">
        <!-- General Financial Insights -->
        <div class="col-lg-6 mb-4" th:if="${generalInsights}">
            <div class="card insight-card h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-lightbulb me-2"></i>
                        Personal Financial Assessment
                        <span class="badge ai-badge ms-2 text-white">AI</span>
                    </h5>
                </div>
                <div class="card-body">
                    <div class="insight-content" th:text="${generalInsights}">
                        Loading insights...
                    </div>
                </div>
            </div>
        </div>
        <!-- Spending Analysis -->
        <div class="col-lg-6 mb-4" th:if="${spendingAnalysis}">
            <div class="card insight-card h-100">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-chart-pie me-2"></i>
                        Spending Pattern Analysis
                        <span class="badge ai-badge ms-2 text-white">AI</span>
                    </h5>
                </div>
                <div class="card-body">
                    <div class="insight-content" th:text="${spendingAnalysis}">
                        Loading spending analysis...
                    </div>
                </div>
            </div>
        </div>
        <!-- Budget Recommendations -->
        <div class="col-12 mb-4" th:if="${budgetRecommendations}">
            <div class="card insight-card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-calculator me-2"></i>
                        Smart Budget Recommendations
                        <span class="badge ai-badge ms-2 text-white">AI</span>
                    </h5>
                </div>
                <div class="card-body">
                    <div class="insight-content" th:text="${budgetRecommendations}">
                        Loading budget recommendations...
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Action Items -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-tasks me-2"></i>Quick Actions</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 mb-2">
                            <a href="/transactions/new" class="btn btn-outline-primary w-100">
                                <i class="fas fa-plus me-2"></i>Add Transaction
                            </a>
                        </div>
                        <div class="col-md-3 mb-2">
                            <a href="/budgets/new" class="btn btn-outline-success w-100">
                                <i class="fas fa-chart-line me-2"></i>Create Budget
                            </a>
                        </div>
                        <div class="col-md-3 mb-2">
                            <a href="/accounts/new" class="btn btn-outline-info w-100">
                                <i class="fas fa-university me-2"></i>Add Account
                            </a>
                        </div>
                        <div class="col-md-3 mb-2">
                            <button onclick="location.reload()" class="btn btn-outline-secondary w-100">
                                <i class="fas fa-sync me-2"></i>Refresh Insights
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>